---
layout:     post
title:     day_06
subtitle:  IIS服务器部署、FTP服务器部署
date:       2020-4-25
author:     One-Punch-Man
header-img: "img/man-6.jpg"
catalog: true
tags: 
     - 网络安全
     - 基础知识
---

# Web服务器

**Web服务器一般指网站服务器**，是指驻留于因特网上某种类型计算机的程序，可以向浏览器等Web客户端提供文档，也可以放置网站文件，让全世界浏览；可以放置数据文件，让全世界下载。常用的Web服务器有三种，分别是**Apache**、**Nginx**、**IIS**。在浏览器和服务器之间使用`HTTP协议`或者`HTTPS协议`进行通信，`HTTP`协议的默认通信端口为`TCP 80`，`HTTPS`协议的默认通信端口为`TCP 443`。

## 部署IIS服务器

1. 手动设置服务器IP地址；
2. 打开我的电脑，点击`CD驱动器:`，在弹出的页面中选择第三项；双击应用程序服务，双击IIS，选择万维网，一路确定；
3. 打开`cmd`，输入 `netstat -an`，出现`TCP 80`端口，说明安装成功；
4. 点击开始 -> 管理工具 ->IIS ->网站 ->禁用默认网站(`C:\Inetpub\wwwroot`)；
5. 点击网站 -> 新建网站 -> 输入网站名 -> 选择网站IP地址 ->选择对外端口 ->  填写主机头(填写**域名**) ->选择需要发布的站点(文件夹) ->点击允许匿名访问，然后一路确定；
6. 右键属性 -> 文档 -> 添加默认文档(站点的首页) ->把添加的文档上移到第一个。 
7. 右键属性 -> 主目录 -> 配置 ->  选项 -> 启动父路径。（可以输入站点子目录下的文件）

### 发布多个网站的三种方法

1. 服务器上有多个网卡，给每一个站点分配不同的IP地址
2. 服务器上不装有多个网卡，给每个不同的站点分配不同的端口号
3. **在发布站点的时候填写不同的主机名（域名），根据域名来进行访问**

# FTP服务器

**FTP服务器**（File Transfer Protocol Server）是在互联网上提供文件存储和访问服务的计算机，它们依照[FTP协议](https://baike.baidu.com/item/FTP协议)提供服务。FTP服务器的默认端口为`TCP 20/21`，**`21`被称作为控制端口，`20`被称为传输端口。**

### 部署FTP服务器

1. 手动设置服务器IP地址；

2. 打开我的电脑，点击`CD驱动器:`，在弹出的页面中选择第三项；双击应用程序服务，双击IIS，选择FTP，一路确定；

3. 打开`cmd`，输入 `netstat -an`，出现`TCP 21`端口，说明安装成功；

4. 点击开始 -> 管理工具 ->IIS ->FTP站点 ->删除默认站点(`C:\Inetpub\ftproot`)；

5. 右键FTP站点 -> 新建站点 -> 填写站点名 -> 选择站点IP地址和端口 -> 选择站点所在的文件夹 -> 选择权限 ，点击完成；

6. 右键新建的站点 -> 点击属性 -> 选择安全账户 -> 取消允许匿名访问。

   > FTP服务器文件的访问权限和共享服务器中的文件权限一样，两者都是与本地的NTFS文件权限相结合取**交集**。

### 工作模式

- **主动模式**（Port）：客户机主动向服务器的`21`端口发送**连接**请求，账号密码验证后，客户机会发送给服务器“我开通了xxxx端口”（Port命令），然后服务器通过`20`端口向客户机的`xxxx`端口建立连接，发送数据；数据发送完毕后`20`端口和`xxxx`会自动关闭。

  ![主动模式](..\img\day_06_01.jpg)

- **被动模式**（Pasv）：客户机主动向服务器的`21`端口发送**连接**请求，账号密码验证后，客户机会发送给服务器“请你随机开启一个端口吧”（Pasv命令），然后服务器随机开启一个高端端口（>1024）并回复客户机在这个端口上进行数据传输，然后客户机在连接到这个端口进行数据传输。

  ![被动模式](..\img\day_06_02.png)

#### 两种模式的优缺点

- **主动FTP对FTP服务器的管理有利，但对客户端的管理不利。**因为FTP服务器企图与客户端的高位随机端口建立连接，而这个端口很有可能被客户端的防火墙阻塞掉。

- **被动FP对FP客户端的管理有利，但对服务器端的管理不利。**因为客户端要与服务器端建立两个连接，其中一个连到一个高位随机端口，而这个端口很有可能被服务器端的防火墙阻塞掉。